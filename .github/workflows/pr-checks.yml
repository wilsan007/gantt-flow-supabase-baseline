name: PR Checks - Build and Test

on:
  pull_request:
    branches: [main, develop]

env:
  NODE_VERSION: '20.x'

jobs:
  build-check:
    name: Build Verification
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v4
      
      - name: ðŸ”§ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - name: ðŸ“¦ Install Dependencies
        run: npm ci --legacy-peer-deps
      
      - name: ðŸ—ï¸ Build Application
        run: npm run build
        env:
          NODE_ENV: production
          CI: false
      
      - name: ðŸ“Š Build Summary
        if: success()
        run: |
          echo "## âœ… Build Successful" >> $GITHUB_STEP_SUMMARY
          
          if [ -d "dist" ]; then
            BUILD_SIZE=$(du -sh dist | cut -f1)
            FILE_COUNT=$(find dist -type f | wc -l)
            echo "ðŸ“¦ **Build Size:** $BUILD_SIZE" >> $GITHUB_STEP_SUMMARY
            echo "ðŸ“„ **Files:** $FILE_COUNT" >> $GITHUB_STEP_SUMMARY
          fi
